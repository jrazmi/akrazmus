{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./db/knex.js","webpack:///./knexfile.js","webpack:///./src/context.js","webpack:///./src/index.js","webpack:///./src/loaders/index.js","webpack:///./src/middleware/auth/index.js","webpack:///./src/middleware/auth/rules/hasGlobalPerm.js","webpack:///./src/middleware/auth/rules/index.js","webpack:///./src/middleware/auth/rules/isAuthenticated.js","webpack:///./src/models/account/index.js","webpack:///./src/models/account/resolvers/me.js","webpack:///./src/models/account/resolvers/register.js","webpack:///./src/models/account/resolvers/requestLogin.js","webpack:///./src/models/account/resolvers/requestPasswordReset.js","webpack:///./src/models/account/resolvers/resetPassword.js","webpack:///./src/models/account/resolvers/updateMe.js","webpack:///./src/models/users/index.js","webpack:///./src/models/users/resolvers/globalPermissions.js","webpack:///./src/models/users/resolvers/user.js","webpack:///./src/models/users/resolvers/users.js","webpack:///./src/resolvers/index.js","webpack:///./src/types/index.js","webpack:///./src/util/FilterQuery.js","webpack:///./src/util/FormatEmail.js","webpack:///./src/util/Prove.js","webpack:///./src/util/aws/index.js","webpack:///./src/util/index.js","webpack:///./src/util/templates/EmailRPR.js","webpack:///external \"aws-sdk\"","webpack:///external \"bcryptjs\"","webpack:///external \"dataloader\"","webpack:///external \"dotenv\"","webpack:///external \"express-jwt\"","webpack:///external \"graphql-shield\"","webpack:///external \"graphql-yoga\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"knex\"","webpack:///external \"lodash\"","webpack:///external \"merge-graphql-schemas\"","webpack:///external \"path\""],"names":["environment","process","config","require","module","exports","test","client","connection","env","TEST_DATABASE_URL","migrations","tableName","directory","seeds","development","debug","DATABASE_URL","production","PRODUCTION_DATABASE_URL","req","res","db","currentUser","loaders","user","id","SingleLoader","email","permissions","global","userId","ManyLoader","where","first","sendEmail","server","GraphQLServer","typeDefs","resolvers","context","request","response","middlewares","AuthMiddleware","express","use","jwt","secret","TOKEN_SECRET","credentialsRequired","getToken","fromHeaderOrQuerystring","headers","authorization","split","query","token","options","endpoint","subscriptions","playground","port","PORT","cors","credentials","origin","FRONTEND_HOST","formatError","err","message","start","console","log","table","key","DataLoader","keys","whereIn","select","then","rows","map","ikey","find","x","filter","FilterLoader","shield","Query","AccountQuery","Mutation","AccountMutation","fallbackError","allowExternalErrors","hasGlobalPerm","perm","rule","cache","root","args","ctx","info","deleted","perms","load","_","includes","isAuthenticated","parent","me","ShieldQuery","requestLogin","register","requestPasswordReset","resetPassword","updateMe","ShieldMutation","formattedEmail","FormatEmail","input","existing","code","success","nextPage","userData","Object","assign","password","bcrypt","hash","insert","return","credAuthError","valid","compare","jsonwebtoken","sign","expiresIn","resetToken","templateParams","link","emailParams","Destination","ToAddresses","Message","Body","Text","Charset","Data","EmailRPR","Html","Subject","Source","FROM_EMAIL","send","e","validJWT","verify","updatedPassword","updatedUser","update","returning","prove","users","User","globalPermissions","u","parseInt","filtered","FilterQuery","build","count","totalCount","items","hasMore","length","limit","UserQuery","typesArray","fileLoader","path","__dirname","typesMerged","mergeTypes","constructor","prepped","prep","compose","clone","sort","order","column","orderBy","toLowerCase","offset","statement","expressions","y","push","class","connector","operations","v","k","subOption","d","operation","value","builder","orWhere","sb","andWhere","innerBuilder","whereNotIn","whereNot","trim","toUpperCase","promise","data","catch","AWS","accessKeyId","AWS_ACCESS_KEY","secretAccessKey","AWS_SECRET_KEY","region","ses","SES","apiVersion","params","type","content","first_name","first_names"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const environment = process.env.NODE_ENV\nconst config = require('../knexfile.js')[environment];\nmodule.exports = require('knex')(config);","require(\"dotenv\").config();\n\nmodule.exports = {\n  test: {\n    client: 'pg',\n    connection: process.env.TEST_DATABASE_URL,\n    migrations: {\n      tableName: \"knex_migrations\",\n      directory: `./db/migrations`\n    },\n    seeds: {\n      directory: './db/seeds/test'\n    }\n  },\n  development: {\n    debug: false,\n    client: \"pg\",\n    connection: process.env.DATABASE_URL,\n    migrations: {\n      tableName: \"knex_migrations\",\n      directory: `./db/migrations`\n    }\n  },\n  production: {\n    client: \"pg\",\n    connection: process.env.PRODUCTION_DATABASE_URL,\n    migrations: {\n      tableName: \"knex_migrations\",\n      directory: `./db/migrations`\n    }\n  }\n};","import { SingleLoader, ManyLoader } from './loaders';\nimport { sendEmail } from '../src/util/aws';\n\nexport default async (req, res, db) => {\n    let currentUser;\n    // initialize dataloaders to context\n    const loaders = {\n        user: {\n            id: SingleLoader(db, 'users', 'id'),\n            email: SingleLoader(db, 'users', 'email')\n        },\n        permissions: {\n            global: {\n                userId: ManyLoader(db, 'global_permissions', 'user_id'),\n            }\n        }\n    }\n\n    // load currentuser into context\n    // do we want to actually load user or no?\n    // console.log(req)\n    if(req && req.user) {\n        currentUser = await db('users').where({id:req.user.id}).first();\n    }\n\n    return {\n        req,\n        res,\n        currentUser: currentUser,\n        db,\n        loaders: loaders,\n        sendEmail: sendEmail\n    }\n};","import { GraphQLServer } from \"graphql-yoga\";\nimport jwt from 'express-jwt';\nimport resolvers from \"./resolvers\";\nimport typeDefs from \"./types\";\nimport context from './context';\nimport { AuthMiddleware } from './middleware/auth';\nconst db = require('../db/knex.js');\n\nrequire(\"dotenv\").config();\n\nconst server = new GraphQLServer({\n    typeDefs,\n    resolvers,\n    context: ({request, response}) => context(request,response, db),\n    middlewares:[\n      AuthMiddleware\n    ]\n});\n\nserver.express.use(jwt({\n    secret: process.env.TOKEN_SECRET,\n    credentialsRequired: false,\n    //allow for auth header or token query param\n    getToken: function fromHeaderOrQuerystring (req) {\n      if (req.headers.authorization && req.headers.authorization.split(' ')[0] === 'Bearer') {\n        return req.headers.authorization.split(' ')[1];\n      } else if (req.query && req.query.token) {\n        return req.query.token;\n      }\n      return null;\n    }\n  }));\n\n\nconst options = {\n  endpoint: \"/graphql\",\n  subscriptions: \"/subscriptions\",\n  playground: \"/playground\",\n  port: process.env.PORT || 4000,\n  cors: {\n    credentials: true,\n    origin: process.env.NODE_ENV === 'test' ? '*' : process.env.FRONTEND_HOST\n  },\n  formatError: err => {\n    return {message: err.message}\n  }\n}\n\n\nserver.start(options, ({port}) => {\n  console.log(`Server started, listening on port ${port} for incoming requests.`);\n});\n","import DataLoader from 'dataloader';\n\nexport const SingleLoader = (db, table, key) => new DataLoader(\n    (keys) => {\n        return(\n            db.table(table)\n            .whereIn(key, keys).select()\n            .then(rows => {\n                return(\n                    keys.map(ikey=>{\n                        return(\n                            rows.find(x=>x[key] === ikey)\n                        )\n                    }\n                    )\n                )\n            })\n        )\n    }\n)\n\nexport const ManyLoader = (db, table, key) => new DataLoader(\n    (keys) => {\n        return(\n            db.table(table)\n            .whereIn(key, keys).select()\n            .then(rows => {\n                return(\n                    keys.map(ikey=>{\n                        return(\n                            rows.filter(x=>x[key] === ikey)\n                        )\n                    }\n                    )\n                )\n            })\n        )\n    }\n)\n\nexport const FilterLoader = (query) => new DataLoader(\n    (keys) => {\n        query\n        .then(rows => {\n            return(\n                keys.map(id => {\n                    return(\n                        rows.filter(x=>x.id === id)\n                    )\n                })\n            )\n        }) \n    }\n)","import { shield } from 'graphql-shield';\n\nimport { ShieldQuery as AccountQuery, ShieldMutation as AccountMutation } from '../../models/account';\n\n\nexport const AuthMiddleware = shield({\n        Query:{\n            ...AccountQuery\n        },\n        Mutation:{\n            ...AccountMutation\n        }, \n    },\n    {\n        fallbackError: \"Not Authorized\",\n        debug: process.env.NODE_ENV !== \"production\",\n        allowExternalErrors: true\n    }\n);","import { rule } from 'graphql-shield';\nimport _ from \"lodash\";\n\nexport const hasGlobalPerm = (perm) => rule({cache: \"contextual\"})(async(root,args,ctx,info) => {\n    if(!ctx.currentUser) return false;\n    if(ctx.currentUser.deleted) return false;\n    const perms = await ctx.loaders.permissions.global.userId.load(ctx.currentUser.id);\n    // iterate over permissions map permission values to an array\n    // return true/false if permission exists\n    return _.includes(_.map(perms, 'permission'), perm);\n})","export { isAuthenticated } from './isAuthenticated';\nexport { hasGlobalPerm } from './hasGlobalPerm';","import { rule } from 'graphql-shield';\n\nexport const isAuthenticated = rule({cache: \"contextual\"})(async(parent, args, ctx) => {\n    if(!ctx.currentUser) return false;\n    if(ctx.currentUser.deleted) return false;\n    return true\n})","import { me } from './resolvers/me';\nimport { requestLogin } from './resolvers/requestLogin';\nimport { register } from './resolvers/register';\nimport { requestPasswordReset } from './resolvers/requestPasswordReset';\nimport { resetPassword } from './resolvers/resetPassword';\nimport { updateMe } from './resolvers/updateMe';\nimport { isAuthenticated } from '../../middleware/auth/rules';\n\nexport const Query = {\n    me\n}\n\nexport const ShieldQuery = {\n    me: isAuthenticated\n}\n\n\nexport const Mutation = {\n    requestLogin,\n    register,\n    requestPasswordReset,\n    resetPassword,\n    updateMe,\n}\n\nexport const ShieldMutation = {\n    updateMe: isAuthenticated\n}","export const me = async(root,args,ctx,info) => {\n    return ctx.currentUser\n}","import { FormatEmail } from '../../../util';\nimport bcrypt from 'bcryptjs';\n\nexport const register = async(root,args,ctx,info) => {\n    // Load user from formatted email\n    const formattedEmail = FormatEmail(args.input.email);\n    const existing = await ctx.loaders.user.email.load(formattedEmail);\n    if(existing){\n        return(\n            {\n                code: \"DUPLICATE\",\n                success: false,\n                message: \"Go Log In!\",\n                nextPage: \"/login\"\n            }\n        )\n    }\n\n    const userData = Object.assign({}, args.input, {\n        password: await bcrypt.hash(args.input.password, 10),\n        email: formattedEmail,\n    });\n\n    const user = await ctx.db('users').insert(userData).return('*');\n    \n    return(\n        {\n            code: \"OK\",\n            success: true,\n            message: \"Go Log In!\",\n            nextPage: \"/login\"\n        }\n    )\n\n}","import jsonwebtoken from 'jsonwebtoken';\nimport bcrypt from 'bcryptjs';\nimport { FormatEmail } from '../../../util';\n\nexport const requestLogin = async(root,args,ctx,info) => {\n    // Load user from formatted email\n    const user = await ctx.loaders.user.email.load(FormatEmail(args.email));\n\n    //set Generic Invalid Credential error\n    const credAuthError = { code: \"DOES_NOT_EXIST\", success: false, message: \"Could not find matching user with these credentials\"};\n\n    // if no user exists return GIC\n    if(!user){\n        return credAuthError\n    }\n\n    // compare password and return GIC if mismatch\n    const valid = await bcrypt.compare(args.password, user.password);\n    if(!valid){\n        return credAuthError\n    }\n\n    //if user has been deleted/suspended return susspension error\n    if(user.deleted){\n        return { code: \"REVOKED\", success: false, message: \"Access for this user account has been revoked.\"}\n    }\n\n    // set token for user\n    const token = jsonwebtoken.sign({ id: user.id, email: user.email }, process.env.TOKEN_SECRET, {\n        expiresIn: '30d'\n    })\n    \n    \n\n    return {\n        code: \"OK\",\n        success: true,\n        message: \"Login Successful\",\n        token: token,\n    }\n};\n","import { FormatEmail } from '../../../util';\nimport { EmailRPR } from '../../../util/templates/EmailRPR';\nimport jsonwebtoken from 'jsonwebtoken';\n\nexport const requestPasswordReset = async ( root, args, ctx, info ) => {\n    // Load user from formatted email\n    const formattedEmail = FormatEmail(args.email);\n    const user = await ctx.loaders.user.email.load(formattedEmail);\n\n    //set Generic Invalid Credential error\n    const credAuthError = { code: \"DOES_NOT_EXIST\", success: false, message: \"Could not find matching user with these credentials\"};\n\n    //if not user return GIC\n    if(!user){\n        return credAuthError\n    }\n    const resetToken = jsonwebtoken.sign({ id: user.id, email: user.email }, process.env.TOKEN_SECRET, {\n        expiresIn: '1h'\n    });\n\n    const templateParams = {\n        link: `${args.link}?token=${resetToken}`,\n        user: user\n    }\n\n    // construct email parameters\n    const emailParams = {\n        Destination: {\n            ToAddresses: [user.email]\n          },\n          Message: {\n            Body: {\n              Text: {\n                Charset: \"UTF-8\",\n                Data: EmailRPR(\"text\", templateParams)\n              },\n              Html: {\n                Charset: \"UTF-8\",\n                Data: EmailRPR(\"html\", templateParams)\n              }\n            },\n            Subject: {\n              Charset: \"UTF-8\",\n              Data: \"Request Password Reset\"\n            }\n          },\n          Source: process.env.FROM_EMAIL\n    }\n    // try to send it otherwise you know... error.\n    try {\n      const send = await ctx.sendEmail(emailParams);\n      return{\n        code: \"OK\",\n        success: true,\n        message: \"Check your email for a reset link\"\n      }\n    } catch (e) {\n      console.log(e)\n      return {\n        code: \"INPUT_ERROR\",\n        success: false,\n        message: \"Email could not be sent\"\n      }\n    }\n}","import jsonwebtoken from 'jsonwebtoken';\nimport { FormatEmail } from '../../../util';\nimport bcrypt from 'bcryptjs';\n\nexport const resetPassword = async ( root, args, ctx, info ) => {\n    let validJWT;\n    //verify that a valid jwt was passed in\n    try {\n        validJWT = await jsonwebtoken.verify(args.token, process.env.TOKEN_SECRET);\n    } catch(e){\n        return({\n            code: \"EXPIRED\",\n            success: false,\n            message: \"This token is either invalid or expired\"\n        })\n    }\n\n    // get user from jwt args\n    const user = await ctx.loaders.user.email.load(FormatEmail(validJWT.email));\n    \n    //set Generic Invalid Credential error\n    const credAuthError = { code: \"DOES_NOT_EXIST\", success: false, message: \"Could not find matching user with these credentials\"};\n\n    // if no user exists return GIC\n    if(!user){\n        return credAuthError\n    }\n\n    // bcrypt new password\n    const updatedPassword = await bcrypt.hash(args.password, 10);\n\n    //update new password\n    const updatedUser = await ctx.db('users').where('id', user.id).update({password: updatedPassword}).returning('*');\n\n    return{\n        code: \"OK\",\n        success: true,\n        message: \"Password has been updated\"\n    }\n}","import { FormatEmail, prove } from '../../../util';\n\nexport const updateMe = async (root, args, ctx, info) => {\n\n    // leaving this in here in case we want to remove user query from context constructor\n    // shouldn't be returned if shield isAuthenticated middleware applied\n    if(!ctx.currentUser){\n        return{\n            code: \"EXPIRED\",\n            success: false,\n            message: \"No current user\"\n        }\n    }\n\n    const [err, update] = await prove(ctx.db('users').where({id: ctx.currentUser.id}).update(args.input));\n    if(err) {\n        return {\n            code: \"ERROR\",\n            success: false,\n            message: err.message ? err.message : 'Unknown error'\n        }\n    }\n    return {\n        code: \"OK\",\n        success: true,\n        message: \"Profile updated\"\n    }\n}","import { globalPermissions } from './resolvers/globalPermissions';\nimport { user } from './resolvers/user';\nimport { users } from './resolvers/users';\n\nexport const Query = {\n    user,\n    users,\n}\n\n\nexport const User = {\n    globalPermissions\n}\n\n","import _ from 'lodash';\n\nexport const globalPermissions = async (root,args,ctx,info) => {\n    //load all global permissions for root user id\n    const perms = await ctx.loaders.permissions.global.userId.load(root.id);\n\n    // map result to an array of perm values\n    return _.map(perms, 'permission');\n}","import { FormatEmail } from '../../../util';\n\nexport const user = async(root,args,ctx,info) => {\n    let u;\n    if(args.id){\n        u = await ctx.loaders.user.id.load(parseInt(args.id));\n    } else if (args.email){\n        u = await ctx.loaders.user.email.load(FormatEmail(args.email));\n    } \n    return u\n}","import { FilterQuery } from '../../../util';\n\nexport const users = async (root, args, ctx, info) => {\n    const filtered = new FilterQuery(ctx.db, 'users', args.input);\n    const build = await filtered.build();\n    const count  = await build.totalCount.returning(\"count\");\n    const items = await build.query;\n    return {\n        hasMore: items.length === filtered.limit + 1,\n        totalCount: count[0].count || 0,\n        items: items\n    }\n}","import { Query as AccountQuery, Mutation as AccountMutation } from '../models/account';\nimport { User, Query as UserQuery } from '../models/users';\n\nexport default {\n    Query:{\n        ...AccountQuery,\n        ...UserQuery\n\n    },\n    Mutation: {\n        ...AccountMutation\n    },\n    User: User,\n}\n","import * as path from \"path\";\nimport { fileLoader, mergeTypes } from \"merge-graphql-schemas\";\n\nconst typesArray = fileLoader(path.join(__dirname, \"../**/*.graphql\"));\nconst typesMerged = mergeTypes(typesArray);\n\nexport default typesMerged;","import _ from 'lodash';\n\n/* \nFilter construction based on Jake Lowen's\nhttps://github.com/jakelowen/sqorn-graphql-filters/blob/master/lib/applyFilters.js\n\n*/\n\n\nexport class FilterQuery {\n    constructor(db, table, input){\n        this.db = db;\n        this.query = this.db(table);\n        this.where = input && input.where ? input.where : null;\n        this.limit = input && input.limit ? input.limit : null;\n        this.sort = input && input.sort ? input.sort : null;\n        this.offset = input && input.offset ? input.offset : null;\n        \n    }\n\n    // construct the query\n    build = async () =>{\n        if(this.where){\n            const prepped = this.prep(this.where);\n            this.query = this.compose(this.query, prepped);\n        }\n\n        const totalCount = this.query.clone().count('*');\n\n        \n        if(this.sort){\n            _.map(this.sort, (order, column) => {\n                this.query = this.query.orderBy(\n                    column, order.toLowerCase()\n                    )\n                })\n            }\n            \n        const limit = this.limit ? this.limit : 20;\n        const offset = this.offset ? this.offset : 0;\n\n        this.query = this.query.limit(limit + 1);\n        this.query = this.query.offset(offset);\n\n        return {query: this.query, totalCount: totalCount}\n    }\n\n    prep = (statement, parent=null) => {\n        const expressions = [];\n        _.map(statement, (x,y) => {\n            \n            if( y === \"OR\"){\n                expressions.push({\n                    class: \"PARENT\",\n                    connector: \"OR\",\n                    parent: parent,\n                    operations: this.prep(x, \"OR\")\n                });\n            }\n            else if( y === \"AND\"){\n                expressions.push({\n                    class: \"PARENT\",\n                    connector: \"AND\",\n                    parent: parent,\n                    operations: this.prep(x, \"AND\")\n                });\n            } else {\n                _.map(x, (v, k) => {\n                    if(k === \"AND\" || k === \"OR\") {\n                        const subOption = this.prep({[k]: v}, parent);\n                        expressions.push(subOption[0])\n                    } else {\n                        _.map(v, (x, d) => {\n                            expressions.push({\n                                class: \"EXPRESSION\",\n                                column: k,\n                                operation: d,\n                                value: x,\n                                parent: parent\n                            })\n                        })\n                    }\n\n                })\n            }\n        })\n        return expressions\n    }\n\n    compose = (builder, expressions) => {\n        _.map(expressions, statement => {\n     \n            switch(statement.class){\n                case \"PARENT\": {\n                    switch(statement.parent){\n                        case \"OR\": {\n                            builder = builder.orWhere((sb) => {\n                                return this.compose(sb, statement.operations)\n                            });\n                            break;\n                        } \n                        case \"AND\": {\n                            builder = builder.andWhere((sb) => {\n                                return this.compose(sb, statement.operations);\n                            })\n                            break;\n                        }\n                        default: {\n                            if(statement.connector === \"OR\"){\n                                builder = builder.orWhere((sb) => {\n                                    return this.compose(sb, statement.operations)\n                                });\n                                break;\n                            } else {\n                                builder = builder.andWhere((sb) => {\n                                    return this.compose(sb, statement.operations);\n                                })\n                                break;\n                            }\n\n                        }\n\n                    }\n                }\n                case \"EXPRESSION\": {\n                    switch(statement.parent){\n                        case \"OR\": {\n                            builder = builder.orWhere((sb) => {\n                                return this.operations(sb, statement);\n                            });\n                            break;\n                        }\n                        default: {\n                            builder = builder.andWhere((sb) => {\n                                return this.operations(sb, statement);\n                            })\n                        }\n                    }\n                }\n            }\n        })\n        return builder;\n        \n    }\n\n    operations = (innerBuilder, statement) => {\n        switch(statement.operation){\n            case 'eq':{\n                return innerBuilder.where(statement.column, '=', statement.value);\n            }\n            case 'neq': {\n                return innerBuilder.where(statement.column, '!=', statement.value);\n            }\n            case 'in': {\n                return innerBuilder.whereIn(statement.column, statement.value);\n            }\n            case 'notIn': {\n                return innerBuilder.whereNotIn(statement.column, statement.value);\n            }\n            case 'lt': {\n                return innerBuilder.where(statement.column, '<', statement.value);\n            }\n            case 'lte': {\n                return innerBuilder.where(statement.column, '<=', statement.value);\n            }\n            case 'gt': {\n                return innerBuilder.where(statement.column, '>', statement.value);\n            }\n            case 'gte': {\n                return innerBuilder.where(statement.column, '>=', statement.value);\n            }\n            case 'contains': {\n                return innerBuilder.where(statement.column, 'ilike', `%${statement.value}%`);\n            }\n            case 'notContains':{\n                return innerBuilder.whereNot(statement.column, 'ilike', `%${statement.value}%`);\n            }\n            case 'startsWith': {\n                return innerBuilder.where(statement.column, 'ilike', `${statement.value}%`);\n            }\n            case 'notStartsWith': {\n                return innerBuilder.whereNot(statement.column, 'ilike', `${statement.value}%`);\n            }\n            case 'endsWith': {\n                return innerBuilder.where(statement.column, 'ilike', `%${statement.value}`);\n            }\n            case 'notEndsWith': {\n                return innerBuilder.whereNot(statement.column, 'ilike', `%${statement.value}`);\n            }\n            default:\n                break;\n        }\n   \n    }\n  \n}","export const FormatEmail = (email) => {\n    return email.trim().toUpperCase()\n}","export const prove = (promise) => {\n    return promise.then(data => [null, data]).catch(err => [err])\n}","import AWS from 'aws-sdk';\n\nAWS.config.update({\n    accessKeyId: process.env.AWS_ACCESS_KEY,\n    secretAccessKey: process.env.AWS_SECRET_KEY,\n    region: 'us-east-1'\n})\n\nconst ses = new AWS.SES({apiVersion: '2010-12-01'});\n\n\n// init send function for test mocking\nexport const sendEmail = async(params) => {\n    return await ses.sendEmail(params).promise()\n};\n\n\n","export { FormatEmail } from './FormatEmail';\nexport { prove } from './Prove';\nexport { FilterQuery } from './FilterQuery';","export const EmailRPR = (type, content) => {\n\tif (type ==='text'){\n\t\treturn(\n\t\t\t`\n\t\t\t${content.user.first_name || \"friend\"}\n\t\t\tReset your password: ${content.link}\n\t\t\t`\n\t\t)\n\t}\n\n\treturn(\n\t\t`<html xmlns=\"http://www.w3.org/1999/xhtml\">\n\t\t<head>\n\t\t\t<title>Reset Password Request</title>\n\t\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"><meta name=\"viewport\" content=\"width=device-width\">\n\t\t\t<style type=\"text/css\">@media only screen and (max-width:600px){body[yahoo=fix] .wrapper-inner{width:100%!important;margin:0!important;padding:0!important;-webkit-text-size-adjust:none}body[yahoo=fix] img{max-width:100%;height:auto!important}body[yahoo=fix] .content{font-size:15px;padding-top:1em;padding-bottom:1em;margin:0 20px}body[yahoo=fix] .footer{width:100%!important;padding:0!important}body[yahoo=fix] .footer .unsub{width:70%!important}body[yahoo=fix] .footer .social{width:15%!important}body[yahoo=fix] .footer .social a{padding:.5em;display:block}body[yahoo=fix] .footer .social a img{display:block;margin:0 auto}body[yahoo=fix] .footer p{font-size:12px!important;line-height:1.4!important;padding-left:3%}body[yahoo=fix] .spacer{display:none}}@media only screen and (max-width:480px){table[class=footer] p{padding-left:0;text-align:center}table[class=footer] td{display:block!important}table[class=footer] .unsub{width:100%!important}table[class=footer] .gutter{display:none!important}table[class=footer] .social{width:50%!important;float:left;text-align:center}table[class=content] .half-width-button{display:none!important;height:0!important;width:0!important}}.ExternalClass{width:100%}.ExternalClass,.ExternalClass p,.ExternalClass span,.ExternalClass font,.ExternalClass td,.ExternalClass div{line-height:100%}p{margin:1em 0};\n\t\t\t</style>\n\t\t</head>\n\t\t<body style=\"min-width: 100%; margin: 0; padding: 0; font-family: sans-serif; line-height: 1.4; font-size: 15px; background: #ffffff\" yahoo=\"fix\">\n\t\t<table style=\"max-width:900px;margin:0px auto\" width=\"95%\">\n\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t<div style=\"max-width: 700px; width: 95%; margin: 0 auto; font-family: sans-serif; font-size: 18px; line-height: 23.8px; color: #2c2b2c;  padding: 7px 7px 7px 7px;\">\n\t\t\t\t\n\t\t\t\t\t\t<p> Hey ${content.user.first_names || \"friend\"}</p>\n\t\t\t\t\t\t<p> <a href=${content.link}> Reset your password </a></p>\n\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t\t</body>\n\t\t</html>`\n\t)\n}\n","module.exports = require(\"aws-sdk\");","module.exports = require(\"bcryptjs\");","module.exports = require(\"dataloader\");","module.exports = require(\"dotenv\");","module.exports = require(\"express-jwt\");","module.exports = require(\"graphql-shield\");","module.exports = require(\"graphql-yoga\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"knex\");","module.exports = require(\"lodash\");","module.exports = require(\"merge-graphql-schemas\");","module.exports = require(\"path\");"],"sourceRoot":""}